# 一、介绍、体系结构、特点

## 1. 什么是数据仓库

数据仓库是为了帮助企业各个级别进行**决策支持、分析性报告**，提供所有数据类型的战略集合，是为了便于**多维分析和多角度展现**而将数据按特定的模式进行存储所建立起来的关系型数据库，它的数据基于**OLTP源系统**。数据仓库是依照**分析需求、分析维度、分析指标**进行设计的

## 2. 数据仓库体系结构

数据源 -- ETL工程 - 数据仓库存储和管理 - 数据集市(OLAP) - BI工具(数据查询、数据报表、数据分，各类应用)

+ 数据源：业务数据、数据库数据(OLTP)、文档数据、日志数据等

![数据仓库体系结构](https://pic2.zhimg.com/80/v2-d7dbc4c757152f64ebc6cd52009ddbad_720w.jpg)

## 3. 数据仓库的特点

+ 面向主题的(Subject-Oriented): 数据仓库中的数据是按照一定的主题域进行组织

  主题：是指用户使用数据仓库进行决策时所关心的重点方面,一个主题通常与多个操作型信息系统(数据库)相关

+ 集成的(Integrated): 数据仓库中的综合数据不能从原来分散的数据库系统直接得到，而是多个不同时间点的数据库快照的集合，基于这些快照进行统计、综合和重组后增加到数据仓库中去

+ 反应历史变化的(Time Variant)：数据仓库随着时间变化不断增加新的数据内容、不断删去旧的数据内容、不断更新综合数据

+ 不可修改的(Unchangeable): 数据仓库涉及到的数据操作主要是数据查询，一般情况下并不进行修改操作

  注意：此时的‘不可修改’是针对应用来说的，也就是说，数据仓库的用户进行分析处理是不进行数据更新操作的。但并不是说，在从数据集成输入数据仓库开始到最后被删除的整个生存周期中，所有的数据仓库数据都是永远不变的

# 二、数据仓库粒度确定

## 1. 粒度级别

**粒度：**是指数据仓库的数据单位中**保存数据的细化或综合程度的级别**，细节程度越高，粒度级别就越低；细节程度越低，粒度级别就越高

+ 当数据仓库的空间很有限时，用高粒度级表示数据将比使用低粒度级表示数据的效率要高得多，并且存放数据所需要的字节数和索引项会少很多
+ 低粒度级实际上可以回答任何问题，但在高粒度级上，数据所能处理的问题的数量是有限的
+ 总结：**高粒度查询快，而低粒度可以解决的问题比较多**

>  设计数据仓库时需要考虑的三大因素
>
> + 数据量大小
> + 原始空间
> + 处理能力

通常，为了节省所用的存储空间、所需的索引项、以及处理数据的处理器资源，在数据仓库中会将数据进行压缩。

在一个**DSS（决策支持系统）**环境中**查询总体性的问题**比查询单个事件要常见的**多**，它既可以在高粒度级上也可以在低粒度级上得到回答，在不同的粒度级上所使用的资源具有很大的差异。在低粒度级需要查询每一条记录，所以需要大量的资源来回答这个问题。但在高粒度级上，数据进行了很大的压缩，只需要查询很少的记录就能得到一个答案。**如果在高粒度级上包括了足够的细节，则使用高粒度级数据的效率将会高得多**

## 2. 数仓分类

基于粒度将数据仓库分为以下三种类型：

+ 低粒度高细节数仓：如每个客户每个月的每个通话记录
+ 高粒度低细节数仓：如每个客户每个月的综合通话记录
+ 双粒度数仓：两者共存，当用户十分需要提高存储与访问数据的效率，以及非常详细地分析数据的能力

![双粒度](https://pic1.zhimg.com/80/v2-a2bd0ff308cf83dc5d7fad9cc99d3f8c_720w.jpg)

确定数据粒度是数据仓库设计的基础，当数据粒度合理确定后，设计和实现的其他问题就会变得非常容易。相反，如果没有合理地确定粒度，后续的工作就会很难进行下去。在设计和构造数据仓库之初就必须仔细考虑这种权衡。

# 三、数据仓库和数据库的区别

+ 数据量：数据仓库要比数据库庞大得多
+ 用途：数据库用来处理实际的业务，在生产环境就是用来干活的；数据仓库主要用于数据挖掘和数据分析**，辅助领导做决策
+ 数据来源：数据库的数据来自于业务，数据仓库的数据来源于多个数据库
+ 时间维度：数据库只保留当前信息，数据仓库保留数据时间轴上的全部信息
+ 组织方式：数据库是面向业务组织，数据仓库是面向主题组织
+ 建模方式：数据库服从范式建模，数据仓库一般是合理冗余的
+ 设计目的：数据库以存储、管理为主，数据仓库以组织、计算为主

> **数据库与数据仓库的区别实际讲的是OLTP与OLAP的区别**

操作型处理，叫联机事务处理OLTP(On-Line Transaction Processing)：也可以称面向交易的处理系统，它是针对具体业务在数据库联机的日常操作，通常对**少数记录**进行查询、修改。用户较为关心操作的**响应时间、数据的安全性、完整性和并发的支持用户数**等问题。传统的数据库系统作为数据管理的主要手段，主要用于操作型处理

分析型处理，叫联机分析处理OLAP(On-Line Analytical Processing)：一般针对某些主题历史数据进行分析，支持管理决策



